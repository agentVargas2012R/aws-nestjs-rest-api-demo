AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Cognito User Pool & Clients for Authentication
Resources:
  CognitoFuncRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName:
        Fn::Sub: ${AWS::StackName}-role
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service:
            - lambda.amazonaws.com
          Action:
          - sts:AssumeRole
      Policies:
      - PolicyName: SNSPolicy
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action:
            - cognito:*
            Resource: '*'
  UserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      UserPoolName: intllpnt-iapps-dev-userpool
      AccountRecoverySetting:
        RecoveryMechanisms:
        - Name: verified_email
          Priority: 1
      AdminCreateUserConfig:
        AllowAdminCreateUserOnly: false
      Policies:
        PasswordPolicy:
          MinimumLength: 8
          RequireLowercase: true
          RequireNumbers: true
          RequireSymbols: true
          RequireUppercase: true
          TemporaryPasswordValidityDays: 7
      UsernameConfiguration:
        CaseSensitive: true
      AliasAttributes:
      - email
      - preferred_username
      EmailConfiguration:
        EmailSendingAccount: COGNITO_DEFAULT
      MfaConfiguration: false
      Schema:
      - AttributeDataType: String
        Mutable: true
        Name: email
        Required: true
      - AttributeDataType: String
        Mutable: true
        Name: preferred_username
        Required: false
      - AttributeDataType: String
        Mutable: true
        Name: given_name
        Required: true
      - AttributeDataType: String
        Mutable: true
        Name: family_name
        Required: true
      - AttributeDataType: String
        Mutable: true
        Name: name
        Required: true
